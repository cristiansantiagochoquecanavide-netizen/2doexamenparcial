import{a as d,j as e}from"./index-ChjEM8xn.js";import{b as o}from"./react-vendor-AZ7bSPkM.js";/* empty css             */import"./axios-vendor-R-lXtGyY.js";function D(){const[p,_]=o.useState([]),[j,b]=o.useState([]),[f,h]=o.useState(!0),[u,i]=o.useState(!1),[c,g]=o.useState(null),[x,s]=o.useState(null),[t,n]=o.useState({codigo_grupo:"",codigo_mat:"",capacidad_de_grupo:""});o.useEffect(()=>{m()},[]);const m=async()=>{try{h(!0);const[a,r]=await Promise.all([d.get("/grupos"),d.get("/materias")]);_(a.data.data||a.data||[]),b(r.data.data||r.data||[]),s(null)}catch(a){s("Error al cargar los datos"),console.error("Error:",a)}finally{h(!1)}},l=a=>{const{name:r,value:y}=a.target;n({...t,[r]:y})},N=async a=>{a.preventDefault();try{c?(await d.put(`/grupos/${c}`,t),s(null)):(await d.post("/grupos",t),s(null)),n({codigo_grupo:"",codigo_mat:"",capacidad_de_grupo:""}),g(null),i(!1),m()}catch(r){s("Error al guardar el grupo"),console.error("Error:",r)}},v=a=>{n({codigo_grupo:a.codigo_grupo,codigo_mat:a.codigo_mat||"",capacidad_de_grupo:a.capacidad_de_grupo||""}),g(a.codigo_grupo),i(!0)},E=async a=>{if(window.confirm("¿Está seguro de que desea eliminar este grupo?"))try{await d.delete(`/grupos/${a}`),s(null),m()}catch(r){s("Error al eliminar el grupo"),console.error("Error:",r)}},C=()=>{n({codigo_grupo:"",codigo_mat:"",capacidad_de_grupo:""}),g(null),i(!1)};return f?e.jsx("div",{className:"loading",children:"Cargando grupos..."}):e.jsxs("div",{className:"crud-container",children:[e.jsxs("div",{className:"crud-header",children:[e.jsx("h1",{children:"Gestión de Grupos"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>i(!u),children:u?"Cancelar":"Nuevo Grupo"})]}),x&&e.jsx("div",{className:"alert alert-danger",children:x}),u&&e.jsxs("form",{onSubmit:N,className:"crud-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"codigo_grupo",children:"Código *"}),e.jsx("input",{type:"text",id:"codigo_grupo",name:"codigo_grupo",value:t.codigo_grupo,onChange:l,required:!0,placeholder:"Ej: GRP-101A",disabled:!!c})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"codigo_mat",children:"Materia *"}),e.jsxs("select",{id:"codigo_mat",name:"codigo_mat",value:t.codigo_mat,onChange:l,required:!0,children:[e.jsx("option",{value:"",children:"Seleccione una materia"}),j.map(a=>e.jsxs("option",{value:a.codigo_mat,children:[a.nombre_mat," (",a.codigo_mat,")"]},a.codigo_mat))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"capacidad_de_grupo",children:"Cantidad de Estudiantes"}),e.jsx("input",{type:"number",id:"capacidad_de_grupo",name:"capacidad_de_grupo",value:t.capacidad_de_grupo,onChange:l,min:"0",placeholder:"Ej: 30"})]}),!c&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"descripcion",children:"Descripción"}),e.jsx("textarea",{id:"descripcion",name:"descripcion",value:t.descripcion||"",onChange:l,placeholder:"Descripción del grupo",rows:"3"})]}),e.jsxs("div",{className:"form-actions",children:[e.jsxs("button",{type:"submit",className:"btn btn-success",children:[c?"Actualizar":"Crear"," Grupo"]}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:C,children:"Cancelar"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"crud-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Código"}),e.jsx("th",{children:"Materia"}),e.jsx("th",{children:"Estudiantes"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:p.length>0?p.map(a=>e.jsxs("tr",{children:[e.jsx("td",{children:a.codigo_grupo}),e.jsx("td",{children:a.materia?.nombre_mat||a.codigo_mat||"-"}),e.jsx("td",{children:a.capacidad_de_grupo||"-"}),e.jsxs("td",{className:"actions",children:[e.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>v(a),children:"Editar"}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>E(a.codigo_grupo),children:"Eliminar"})]})]},a.codigo_grupo)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center",children:"No hay grupos registrados"})})})]})})]})}export{D as default};
