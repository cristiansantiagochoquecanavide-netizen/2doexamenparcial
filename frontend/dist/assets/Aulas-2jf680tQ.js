import{a as l,j as a}from"./index-FLdvt5S5.js";import{b as t}from"./react-vendor-AZ7bSPkM.js";/* empty css             */import"./axios-vendor-R-lXtGyY.js";function k(){const[p,f]=t.useState([]),[b,g]=t.useState([]),[_,x]=t.useState(!0),[u,c]=t.useState(!1),[d,h]=t.useState(null),[j,n]=t.useState(null),[s,o]=t.useState({nro_aula:"",tipo:"",capacidad:"",id_infraestructura:"",estado:"Disponible"});t.useEffect(()=>{m()},[]);const m=async()=>{try{x(!0);const[e,r]=await Promise.all([l.get("/aulas"),l.get("/infraestructura")]);f(e.data.data||e.data||[]),g(r.data.data||r.data||[]),n(null)}catch(e){let r="Error al cargar los datos";e.response?(r+=` (status: ${e.response.status})`,e.response.data&&e.response.data.message&&(r+=`: ${e.response.data.message}`)):e.message&&(r+=`: ${e.message}`),n(r),console.error("Error detalle:",e)}finally{x(!1)}},i=e=>{const{name:r,value:C,type:S,checked:A}=e.target;o({...s,[r]:S==="checkbox"?A:C})},v=async e=>{e.preventDefault();try{d?(await l.put(`/aulas/${d}`,s),n(null)):(await l.post("/aulas",s),n(null)),o({nro_aula:"",tipo:"",capacidad:"",id_infraestructura:"",estado:"Disponible"}),h(null),c(!1),m()}catch(r){n("Error al guardar el aula"),console.error("Error:",r)}},N=e=>{o({nro_aula:e.nro_aula,tipo:e.tipo||"",capacidad:e.capacidad||"",id_infraestructura:e.id_infraestructura||"",estado:e.estado||"Disponible"}),h(e.nro_aula),c(!0)},E=async e=>{if(window.confirm("¿Está seguro de que desea eliminar esta aula?"))try{await l.delete(`/aulas/${e}`),n(null),m()}catch(r){n("Error al eliminar el aula"),console.error("Error:",r)}},y=()=>{o({nro_aula:"",tipo:"",capacidad:"",id_infraestructura:"",estado:"Disponible"}),h(null),c(!1)};return _?a.jsx("div",{className:"loading",children:"Cargando aulas..."}):a.jsxs("div",{className:"crud-container",children:[a.jsxs("div",{className:"crud-header",children:[a.jsx("h1",{children:"Gestión de Aulas"}),a.jsx("button",{className:"btn btn-primary",onClick:()=>c(!u),children:u?"Cancelar":"Nueva Aula"})]}),j&&a.jsx("div",{className:"alert alert-danger",children:j}),u&&a.jsxs("form",{onSubmit:v,className:"crud-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"nro_aula",children:"Número *"}),a.jsx("input",{type:"text",id:"nro_aula",name:"nro_aula",value:s.nro_aula,onChange:i,required:!0,placeholder:"Ej: 101, A-201",disabled:!!d})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"tipo",children:"Tipo *"}),a.jsx("input",{type:"text",id:"tipo",name:"tipo",value:s.tipo,onChange:i,required:!0,placeholder:"Ej: Aula de Informática, Laboratorio de Química"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"capacidad",children:"Capacidad *"}),a.jsx("input",{type:"number",id:"capacidad",name:"capacidad",value:s.capacidad,onChange:i,required:!0,min:"1",placeholder:"Ej: 40"})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"id_infraestructura",children:"Infraestructura"}),a.jsxs("select",{id:"id_infraestructura",name:"id_infraestructura",value:s.id_infraestructura,onChange:i,children:[a.jsx("option",{value:"",children:"Seleccione infraestructura"}),b.map(e=>a.jsx("option",{value:e.id_infraestructura,children:e.nombre_infr},e.id_infraestructura))]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"estado",children:"Estado"}),a.jsxs("select",{id:"estado",name:"estado",value:s.estado,onChange:i,children:[a.jsx("option",{value:"Disponible",children:"Disponible"}),a.jsx("option",{value:"Mantenimiento",children:"Mantenimiento"}),a.jsx("option",{value:"Ocupado",children:"Ocupado"})]})]}),a.jsxs("div",{className:"form-actions",children:[a.jsxs("button",{type:"submit",className:"btn btn-success",children:[d?"Actualizar":"Crear"," Aula"]}),a.jsx("button",{type:"button",className:"btn btn-secondary",onClick:y,children:"Cancelar"})]})]}),a.jsx("div",{className:"table-responsive",children:a.jsxs("table",{className:"crud-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Número"}),a.jsx("th",{children:"Tipo"}),a.jsx("th",{children:"Capacidad"}),a.jsx("th",{children:"Infraestructura"}),a.jsx("th",{children:"Estado"}),a.jsx("th",{children:"Acciones"})]})}),a.jsx("tbody",{children:p.length>0?p.map(e=>a.jsxs("tr",{children:[a.jsx("td",{children:e.nro_aula}),a.jsx("td",{children:e.tipo||"-"}),a.jsx("td",{children:e.capacidad}),a.jsx("td",{children:e.infraestructura?.nombre_infr||"-"}),a.jsx("td",{children:e.estado||"-"}),a.jsxs("td",{className:"actions",children:[a.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>N(e),children:"Editar"}),a.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>E(e.nro_aula),children:"Eliminar"})]})]},e.nro_aula)):a.jsx("tr",{children:a.jsx("td",{colSpan:"6",className:"text-center",children:"No hay aulas registradas"})})})]})})]})}export{k as default};
