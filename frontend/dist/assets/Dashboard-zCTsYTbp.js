import{u as C,a as g,j as s}from"./index-ChjEM8xn.js";import{b as d}from"./react-vendor-AZ7bSPkM.js";import"./axios-vendor-R-lXtGyY.js";const w=()=>{const{user:P,isAuthenticated:N,isCoordinador:A}=C(),[i,r]=d.useState({total_carga_asignada:0,total_asistencias:0,total_conflictos:0}),[o,n]=d.useState([]),[l,t]=d.useState([]),[h,x]=d.useState([]),[p,b]=d.useState([]),[c,u]=d.useState(""),[v,j]=d.useState(!0),[y,f]=d.useState("");d.useEffect(()=>{m(),_()},[]),d.useEffect(()=>{c&&m()},[c]);const _=async()=>{try{const{data:a}=await g.get("/dashboard/periodos");b(a.periodos||[])}catch(a){console.error("Error al cargar per√≠odos:",a)}},m=async()=>{j(!0),f("");try{const a=c?{periodo_academico:c}:{},{data:e}=await g.get("/dashboard",{params:a});r(e.indicadores),n(e.carga_por_docente||[]),t(e.asistencia_por_periodo||[]),x(e.conflictos_resumido||[])}catch(a){console.error("Error al cargar dashboard:",a),r({total_carga_asignada:0,total_asistencias:0,total_conflictos:0}),n([]),t([]),x([])}finally{j(!1)}};return N?v?s.jsx("div",{className:"dashboard-container",children:s.jsxs("div",{className:"loading",children:[s.jsx("div",{className:"spinner"}),"Cargando indicadores..."]})}):s.jsxs("div",{className:"dashboard-container",children:[s.jsxs("div",{className:"dashboard-header",children:[s.jsx("h1",{children:"CU16 - Visualizar Dashboard"}),s.jsx("p",{children:"Indicadores de planificaci√≥n, asistencia y conflictos"})]}),s.jsx("div",{className:"dashboard-filtros",children:s.jsxs("label",{children:[s.jsx("span",{children:"Filtrar por Per√≠odo Acad√©mico:"}),s.jsxs("select",{value:c,onChange:a=>u(a.target.value),className:"filtro-select",children:[s.jsx("option",{value:"",children:"Todos los per√≠odos"}),p.map((a,e)=>s.jsx("option",{value:a,children:a},e))]})]})}),s.jsxs("div",{className:"indicadores-grid",children:[s.jsxs("div",{className:"indicador-card carga",children:[s.jsx("div",{className:"indicador-icon",children:"üìä"}),s.jsxs("div",{className:"indicador-content",children:[s.jsx("h3",{children:"Carga Asignada"}),s.jsx("p",{className:"indicador-valor",children:i.total_carga_asignada}),s.jsx("span",{className:"indicador-label",children:"asignaciones activas"})]})]}),s.jsxs("div",{className:"indicador-card asistencia",children:[s.jsx("div",{className:"indicador-icon",children:"‚úÖ"}),s.jsxs("div",{className:"indicador-content",children:[s.jsx("h3",{children:"Asistencias"}),s.jsx("p",{className:"indicador-valor",children:i.total_asistencias}),s.jsx("span",{className:"indicador-label",children:"registradas"})]})]}),s.jsxs("div",{className:"indicador-card conflictos",children:[s.jsx("div",{className:"indicador-icon",children:"‚ö†Ô∏è"}),s.jsxs("div",{className:"indicador-content",children:[s.jsx("h3",{children:"Conflictos"}),s.jsx("p",{className:"indicador-valor",children:i.total_conflictos}),s.jsx("span",{className:"indicador-label",children:"detectados"})]})]})]}),s.jsxs("div",{className:"dashboard-grid",children:[s.jsxs("div",{className:"dashboard-card",children:[s.jsx("h2",{children:"Asignaciones de Carga Horaria"}),o.length>0?s.jsxs("table",{className:"dashboard-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"ID Asignaci√≥n"}),s.jsx("th",{children:"C√≥digo Docente"}),s.jsx("th",{children:"Docente"}),s.jsx("th",{children:"Estado"}),s.jsx("th",{children:"Per√≠odo"})]})}),s.jsx("tbody",{children:o.map((a,e)=>s.jsxs("tr",{children:[s.jsx("td",{className:"font-bold",children:a.id_asignacion}),s.jsx("td",{children:a.codigo_doc}),s.jsx("td",{children:a.docente?.usuario?.persona?.nombre||"N/A"}),s.jsx("td",{children:s.jsx("span",{className:`badge badge-${a.estado==="ACTIVO"?"success":"warning"}`,children:a.estado})}),s.jsx("td",{children:a.periodo_academico})]},e))})]}):s.jsx("p",{className:"no-data",children:"No hay asignaciones disponibles"})]}),s.jsxs("div",{className:"dashboard-card",children:[s.jsx("h2",{children:"Asistencia por Per√≠odo"}),l.length>0?s.jsxs("table",{className:"dashboard-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"A√±o"}),s.jsx("th",{children:"Total"})]})}),s.jsx("tbody",{children:l.map((a,e)=>s.jsxs("tr",{children:[s.jsx("td",{children:a.a√±o}),s.jsx("td",{className:"text-center",children:a.total})]},e))})]}):s.jsx("p",{className:"no-data",children:"No hay datos disponibles"})]}),s.jsxs("div",{className:"dashboard-card full-width",children:[s.jsx("h2",{children:"Estado de Conflictos"}),h.length>0?s.jsx("div",{className:"conflictos-grid",children:h.map((a,e)=>s.jsxs("div",{className:`conflicto-badge ${a.estado.toLowerCase()}`,children:[s.jsx("span",{className:"badge-label",children:a.estado}),s.jsx("span",{className:"badge-valor",children:a.total})]},e))}):s.jsx("p",{className:"no-data",children:"No hay conflictos registrados"})]})]})]}):s.jsx("div",{className:"dashboard-container",children:s.jsxs("div",{className:"dashboard-error",children:[s.jsx("strong",{children:"Error:"})," No est√°s autenticado. Por favor, inicia sesi√≥n."]})})};export{w as default};
