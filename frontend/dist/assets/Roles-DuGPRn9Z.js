import{a as c,j as e}from"./index-ChjEM8xn.js";import{b as a}from"./react-vendor-AZ7bSPkM.js";/* empty css             */import"./axios-vendor-R-lXtGyY.js";function S(){const[i,x]=a.useState([]),[f,b]=a.useState(!0),[d,l]=a.useState(!1),[m,h]=a.useState(null),[p,n]=a.useState(null),[t,o]=a.useState({nombre:"",descripcion:""});a.useEffect(()=>{u()},[]);const u=async()=>{try{b(!0);const r=await c.get("/roles");console.log("ðŸ“‹ Roles response en componente:",r.data);let s=r.data;Array.isArray(s)||(console.warn("âš ï¸ Roles no es un array, intentando extraer de .data:",s),s=s.data||[]),Array.isArray(s)||(console.error("âŒ Roles sigue sin ser un array:",s),s=[]),x(s),console.log("âœ… Roles establecidos:",s.length),n(null)}catch(r){n("Error al cargar los roles"),console.error("Error:",r),x([])}finally{b(!1)}},j=r=>{const{name:s,value:v}=r.target;o({...t,[s]:v})},g=async r=>{r.preventDefault();try{m?(await c.put(`/roles/${m}`,t),n(null)):(await c.post("/roles",t),n(null)),o({nombre:"",descripcion:""}),h(null),l(!1),u()}catch(s){n("Error al guardar el rol"),console.error("Error:",s)}},y=r=>{o({nombre:r.nombre,descripcion:r.descripcion}),h(r.id_rol),l(!0)},N=async r=>{if(window.confirm("Â¿EstÃ¡ seguro de que desea eliminar este rol?"))try{await c.delete(`/roles/${r}`),n(null),u()}catch(s){n("Error al eliminar el rol"),console.error("Error:",s)}},E=()=>{o({nombre:"",descripcion:""}),h(null),l(!1)};return f?e.jsx("div",{className:"loading",children:"Cargando roles..."}):e.jsxs("div",{className:"crud-container",children:[e.jsxs("div",{className:"crud-header",children:[e.jsx("h1",{children:"GestiÃ³n de Roles"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>l(!d),children:d?"Cancelar":"Nuevo Rol"})]}),p&&e.jsx("div",{className:"alert alert-danger",children:p}),d&&e.jsxs("form",{onSubmit:g,className:"crud-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nombre",children:"Nombre del Rol *"}),e.jsx("input",{type:"text",id:"nombre",name:"nombre",value:t.nombre,onChange:j,required:!0,placeholder:"Ej: Administrador, Docente, Estudiante"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"descripcion",children:"DescripciÃ³n"}),e.jsx("textarea",{id:"descripcion",name:"descripcion",value:t.descripcion,onChange:j,placeholder:"DescripciÃ³n del rol",rows:"4"})]}),e.jsxs("div",{className:"form-actions",children:[e.jsxs("button",{type:"submit",className:"btn btn-success",children:[m?"Actualizar":"Crear"," Rol"]}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:E,children:"Cancelar"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"crud-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"DescripciÃ³n"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:Array.isArray(i)&&i.length>0?i.map(r=>e.jsxs("tr",{children:[e.jsx("td",{children:r.id_rol}),e.jsx("td",{children:r.nombre}),e.jsx("td",{children:r.descripcion||"-"}),e.jsxs("td",{className:"actions",children:[e.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>y(r),children:"Editar"}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>N(r.id_rol),children:"Eliminar"})]})]},r.id_rol)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center",children:"No hay roles registrados"})})})]})})]})}export{S as default};
