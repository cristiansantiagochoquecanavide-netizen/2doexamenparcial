import{a as l,j as e}from"./index-FLdvt5S5.js";import{b as s}from"./react-vendor-AZ7bSPkM.js";/* empty css             */import"./axios-vendor-R-lXtGyY.js";function w(){const[f,p]=s.useState([]),[g,x]=s.useState(!0),[d,i]=s.useState(!1),[u,m]=s.useState(null),[j,t]=s.useState(null),[n,o]=s.useState({nombre_infr:"",ubicacion:"",estado:""});s.useEffect(()=>{h()},[]);const h=async()=>{try{x(!0);const r=await l.get("/infraestructura");console.log("Response:",r);const a=r.data.data||r.data||[];console.log("Extracted data:",a),p(a),t(null)}catch(r){console.error("Full error:",r),console.error("Error response:",r.response),t("Error al cargar las infraestructuras")}finally{x(!1)}},b=r=>{const{name:a,value:c}=r.target;o({...n,[a]:c})},E=async r=>{r.preventDefault();try{u?(await l.put(`/infraestructura/${u}`,n),t(null)):(await l.post("/infraestructura",n),t(null)),o({nombre_infr:"",ubicacion:"",estado:""}),m(null),i(!1),h()}catch(a){let c="Error al guardar la infraestructura";a.response&&a.response.data&&a.response.data.error?c+=": "+a.response.data.error:a.message&&(c+=": "+a.message),t(c),console.error("Error:",a)}},N=r=>{o({nombre_infr:r.nombre_infr,ubicacion:r.ubicacion||"",estado:r.estado||""}),m(r.id_infraestructura),i(!0)},v=async r=>{if(window.confirm("¿Está seguro de que desea eliminar esta infraestructura?"))try{await l.delete(`/infraestructura/${r}`),t(null),h()}catch(a){t("Error al eliminar la infraestructura"),console.error("Error:",a)}},y=()=>{o({nombre_infr:"",ubicacion:"",estado:""}),m(null),i(!1)};return g?e.jsx("div",{className:"loading",children:"Cargando infraestructuras..."}):e.jsxs("div",{className:"crud-container",children:[e.jsxs("div",{className:"crud-header",children:[e.jsx("h1",{children:"Gestión de Infraestructura"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>i(!d),children:d?"Cancelar":"Nueva Infraestructura"})]}),j&&e.jsx("div",{className:"alert alert-danger",children:j}),d&&e.jsxs("form",{onSubmit:E,className:"crud-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"nombre_infr",children:"Nombre *"}),e.jsx("input",{type:"text",id:"nombre_infr",name:"nombre_infr",value:n.nombre_infr,onChange:b,required:!0,placeholder:"Ej: Edificio A, Pabellón B"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"ubicacion",children:"Ubicación"}),e.jsx("input",{type:"text",id:"ubicacion",name:"ubicacion",value:n.ubicacion,onChange:b,placeholder:"Ej: Planta 1, Zona Sur"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"estado",children:"Estado"}),e.jsx("input",{type:"text",id:"estado",name:"estado",value:n.estado,onChange:b,placeholder:"Ej: Activo, Disponible"})]}),e.jsxs("div",{className:"form-actions",children:[e.jsxs("button",{type:"submit",className:"btn btn-success",children:[u?"Actualizar":"Crear"," Infraestructura"]}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:y,children:"Cancelar"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"crud-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Ubicación"}),e.jsx("th",{children:"Estado"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:f.length>0?f.map(r=>e.jsxs("tr",{children:[e.jsx("td",{children:r.id_infraestructura}),e.jsx("td",{children:r.nombre_infr}),e.jsx("td",{children:r.ubicacion||"-"}),e.jsx("td",{children:r.estado||"-"}),e.jsxs("td",{className:"actions",children:[e.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>N(r),children:"Editar"}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>v(r.id_infraestructura),children:"Eliminar"})]})]},r.id_infraestructura)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center",children:"No hay infraestructuras registradas"})})})]})})]})}export{w as default};
