import{a as d,j as e}from"./index-ChjEM8xn.js";import{b as c}from"./react-vendor-AZ7bSPkM.js";/* empty css                             */import"./axios-vendor-R-lXtGyY.js";const A=()=>{console.log("üîç GestionInasistencias componente montado");const[h,m]=c.useState([]),[v,j]=c.useState(!1),[i,u]=c.useState(null),[p,o]=c.useState(!1),[n,r]=c.useState({estado:"PENDIENTE",desde:"",hasta:""}),[a,t]=c.useState({decision:"",tipo_accion:"",descripcion:"",comentario:""});c.useEffect(()=>{console.log("‚ö° useEffect activado, cargando inasistencias..."),x()},[n]);const x=async()=>{try{j(!0);const s=new URLSearchParams(n),{data:l}=await d.get(`/inasistencias?${s}`);m(l.data.data||[])}catch(s){console.error("Error cargando inasistencias:",s)}finally{j(!1)}},g=async s=>{try{const{data:l}=await d.get(`/inasistencias/${s}`);u(l.data),o(!0)}catch(l){console.error("Error cargando detalle:",l)}},f=async()=>{if(!a.decision||!a.tipo_accion){alert("Complete los campos requeridos");return}try{const{data:s}=await d.post(`/inasistencias/${i.id_inasistencia}/revisar`,{...a,id_inasistencia:i.id_inasistencia});alert("Inasistencia resuelta exitosamente"),o(!1),t({}),x()}catch(s){console.error("Error:",s),alert("Error al resolver inasistencia")}};return e.jsxs("div",{className:"gestion-inasistencias",children:[e.jsxs("div",{className:"header",children:[e.jsx("h1",{children:"üìã Gesti√≥n de Inasistencias y Justificaciones"}),e.jsx("p",{children:"Revisar y procesar justificativos de docentes"})]}),e.jsxs("div",{className:"filtros-section",children:[e.jsx("h3",{children:"Filtros"}),e.jsxs("div",{className:"filtros-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Estado"}),e.jsxs("select",{value:n.estado,onChange:s=>r({...n,estado:s.target.value}),children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"PENDIENTE",children:"Pendiente"}),e.jsx("option",{value:"EN_REVISION",children:"En Revisi√≥n"}),e.jsx("option",{value:"RESUELTA",children:"Resuelta"}),e.jsx("option",{value:"RECHAZADA",children:"Rechazada"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Desde"}),e.jsx("input",{type:"date",value:n.desde,onChange:s=>r({...n,desde:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Hasta"}),e.jsx("input",{type:"date",value:n.hasta,onChange:s=>r({...n,hasta:s.target.value})})]})]})]}),e.jsx("div",{className:"tabla-section",children:v?e.jsx("div",{className:"loading",children:"Cargando..."}):h.length===0?e.jsx("div",{className:"sin-datos",children:"No hay inasistencias para mostrar"}):e.jsxs("table",{className:"tabla-inasistencias",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Docente"}),e.jsx("th",{children:"Fecha"}),e.jsx("th",{children:"Motivo"}),e.jsx("th",{children:"Estado"}),e.jsx("th",{children:"Tipo"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:h.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.codigo_doc||"-"}),e.jsx("td",{children:new Date(s.fecha).toLocaleDateString()}),e.jsx("td",{children:s.motivo_aparente||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge estado-${s.estado.toLowerCase()}`,children:s.estado})}),e.jsx("td",{children:s.tipo_inasistencia}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-small",onClick:()=>g(s.id_inasistencia),children:"Revisar"})})]},s.id_inasistencia))})]})}),p&&i&&e.jsx("div",{className:"modal-overlay",onClick:()=>o(!1),children:e.jsxs("div",{className:"modal-contenido",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Revisar Inasistencia"}),e.jsx("button",{className:"close",onClick:()=>o(!1),children:"‚úï"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"info-section",children:[e.jsx("h3",{children:"Informaci√≥n del Docente"}),e.jsxs("p",{children:[e.jsx("strong",{children:"C√≥digo:"})," ",i.codigo_doc]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Fecha:"})," ",new Date(i.fecha).toLocaleDateString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Motivo:"})," ",i.motivo_aparente||"-"]})]}),i.justificativos&&i.justificativos.length>0&&e.jsxs("div",{className:"justificativos-section",children:[e.jsx("h3",{children:"Justificativos Presentados"}),i.justificativos.map(s=>e.jsxs("div",{className:"justificativo-card",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Motivo:"})," ",s.motivo_justificacion]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Archivo:"})," ",s.archivo_nombre_original]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Tipo:"})," ",s.archivo_tipo," - ",(s.archivo_tama√±o/1024).toFixed(2)," KB"]}),e.jsx("button",{className:"btn btn-small",children:"üì• Descargar"})]},s.id_justificativo))]}),e.jsxs("div",{className:"resolucion-section",children:[e.jsx("h3",{children:"Resoluci√≥n de Inasistencia"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Decisi√≥n *"}),e.jsxs("select",{value:a.decision,onChange:s=>t({...a,decision:s.target.value}),className:"form-control",children:[e.jsx("option",{value:"",children:"Seleccione decisi√≥n"}),e.jsx("option",{value:"APROBADA",children:"‚úÖ Aprobada"}),e.jsx("option",{value:"RECHAZADA",children:"‚ùå Rechazada"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tipo de Acci√≥n *"}),e.jsxs("select",{value:a.tipo_accion,onChange:s=>t({...a,tipo_accion:s.target.value}),className:"form-control",children:[e.jsx("option",{value:"",children:"Seleccione acci√≥n"}),e.jsx("option",{value:"REPOSICION",children:"Reposici√≥n de clase"}),e.jsx("option",{value:"AJUSTE",children:"Ajuste de calificaci√≥n"}),e.jsx("option",{value:"CONDONACION",children:"Condonaci√≥n"}),e.jsx("option",{value:"NINGUNA",children:"Ninguna"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Descripci√≥n de la Acci√≥n"}),e.jsx("textarea",{value:a.descripcion,onChange:s=>t({...a,descripcion:s.target.value}),placeholder:"Detalles de la acci√≥n a ejecutar...",rows:"3",className:"form-control"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Comentario (para el justificativo)"}),e.jsx("textarea",{value:a.comentario,onChange:s=>t({...a,comentario:s.target.value}),placeholder:"Observaciones sobre el justificativo...",rows:"2",className:"form-control"})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>o(!1),children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary",onClick:f,children:"Guardar Resoluci√≥n"})]})]})})]})};export{A as default};
